<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResumeForge · Professional Resume Tools</title>
    <meta name="description" content="Complete resume toolkit - create, edit, analyze, optimize, and download professional resumes">
    <!-- Bootstrap + icons + font -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,400..700;1,14..32,400..700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(145deg, #eef3fc, #fbfeff);
            min-height: 100vh;
            padding: 20px 0;
        }
        .app-wrapper {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Google Ad Spaces */
        .google-ad-space {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            border: 2px dashed #1d2b64;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .google-ad-placeholder {
            color: #1d2b64;
            font-weight: 600;
            font-size: 1.2rem;
        }

        /* Modern Header */
        .app-header {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(12px);
            border-radius: 30px;
            padding: 16px 30px;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px -10px rgba(0,20,60,0.15);
            border: 1px solid rgba(255,255,255,0.5);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            background: #1d2b64;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            transform: rotate(10deg);
            transition: 0.3s;
        }
        
        .logo-icon:hover {
            transform: rotate(0deg) scale(1.1);
        }
        
        .logo-text h1 {
            font-weight: 700;
            font-size: 1.8rem;
            margin: 0;
            background: linear-gradient(135deg, #1d2b64, #2a3f8a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .logo-text p {
            margin: 0;
            font-size: 0.85rem;
            color: #666;
        }

        /* Main Layout */
        .editor-layout {
            display: grid;
            grid-template-columns: 280px 1fr 320px;
            gap: 20px;
            margin-bottom: 30px;
        }

        /* Left Toolbar */
        .tools-panel {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(12px);
            border-radius: 30px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.5);
            box-shadow: 0 15px 35px -10px rgba(0,20,60,0.15);
            height: fit-content;
        }

        .tools-header {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(29,43,100,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tools-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .tool-btn {
            background: transparent;
            border: none;
            padding: 12px 15px;
            border-radius: 20px;
            text-align: left;
            font-weight: 500;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #333;
            width: 100%;
        }
        
        .tool-btn i {
            font-size: 1.4rem;
            width: 30px;
            color: #1d2b64;
        }
        
        .tool-btn:hover {
            background: rgba(29,43,100,0.1);
            transform: translateX(5px);
        }
        
        .tool-btn.active {
            background: #1d2b64;
            color: white;
        }
        
        .tool-btn.active i {
            color: white;
        }

        /* Center Panel (Resume Editor) */
        .canvas-panel {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(12px);
            border-radius: 30px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.5);
            box-shadow: 0 15px 35px -10px rgba(0,20,60,0.15);
            min-height: 600px;
        }

        .resume-preview {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }

        .resume-header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 2px solid #1d2b64;
            padding-bottom: 20px;
        }
        
        .resume-name {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1d2b64;
            margin-bottom: 5px;
        }
        
        .resume-title {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 10px;
        }
        
        .resume-contact {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 0.9rem;
        }

        .resume-section {
            margin-bottom: 25px;
        }
        
        .resume-section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1d2b64;
            border-bottom: 1px solid #d0ddee;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }

        .resume-item {
            margin-bottom: 15px;
        }
        
        .resume-item-header {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
        }
        
        .resume-item-sub {
            color: #666;
            font-size: 0.9rem;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        /* Right Properties Panel */
        .properties-panel {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(12px);
            border-radius: 30px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.5);
            box-shadow: 0 15px 35px -10px rgba(0,20,60,0.15);
            height: fit-content;
            max-height: 600px;
            overflow-y: auto;
        }

        .prop-section {
            margin-bottom: 25px;
        }
        
        .prop-title {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #1d2b64;
        }

        .prop-control {
            margin-bottom: 15px;
        }
        
        .prop-control label {
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 5px;
            display: block;
        }

        .range-slider {
            width: 100%;
            height: 6px;
            border-radius: 10px;
            background: #d0ddee;
            outline: none;
            -webkit-appearance: none;
        }
        
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #1d2b64;
            cursor: pointer;
            transition: 0.1s;
        }
        
        .range-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .tool-input, .tool-select, .tool-textarea {
            width: 100%;
            padding: 10px 15px;
            border-radius: 30px;
            border: 1px solid #d0ddee;
            background: white;
            font-weight: 500;
        }
        
        .tool-textarea {
            border-radius: 20px;
            resize: vertical;
            min-height: 80px;
        }

        .badge-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .badge-item {
            background: #ecf2fc;
            border-radius: 30px;
            padding: 5px 12px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .badge-item i {
            cursor: pointer;
            color: #dc3545;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-primary-custom {
            background: #1d2b64;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 12px;
            font-weight: 600;
            transition: 0.2s;
        }
        
        .btn-primary-custom:hover {
            background: #2f3e8a;
            transform: scale(1.02);
        }
        
        .btn-secondary-custom {
            background: #ecf2fc;
            color: #1d2b64;
            border: none;
            border-radius: 20px;
            padding: 12px;
            font-weight: 600;
            transition: 0.2s;
        }
        
        .btn-secondary-custom:hover {
            background: #d0ddee;
        }

        /* Bottom Toolbar */
        .bottom-toolbar {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(12px);
            border-radius: 30px;
            padding: 15px 25px;
            margin-top: 20px;
            border: 1px solid rgba(255,255,255,0.5);
            box-shadow: 0 15px 35px -10px rgba(0,20,60,0.15);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .history-actions {
            display: flex;
            gap: 10px;
        }
        
        .history-btn {
            background: #ecf2fc;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            color: #1d2b64;
            transition: 0.2s;
        }
        
        .history-btn:hover {
            background: #1d2b64;
            color: white;
        }
        
        .history-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .resume-stats {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .resume-stats span {
            font-weight: 600;
            color: #1d2b64;
        }

        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 12px 30px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.2s;
        }
        
        .export-btn:hover {
            background: #34ce57;
            transform: scale(1.05);
        }

        /* Dark Mode */
        .dark-mode {
            background: #0f1a2f;
            color: #e2ecff;
        }
        
        .dark-mode .app-header,
        .dark-mode .tools-panel,
        .dark-mode .canvas-panel,
        .dark-mode .properties-panel,
        .dark-mode .bottom-toolbar {
            background: #1d2a44cc;
            border-color: #33415e;
            color: white;
        }
        
        .dark-mode .resume-preview {
            background: #1e2a40;
            color: #e2ecff;
        }
        
        .dark-mode .resume-title,
        .dark-mode .resume-item-sub {
            color: #aab8e0;
        }
        
        .dark-mode .tool-btn {
            color: #e2ecff;
        }
        
        .dark-mode .tool-btn i {
            color: #8a9fd1;
        }
        
        .dark-mode .tool-btn.active {
            background: #2f3e8a;
        }
        
        .dark-mode .logo-text p {
            color: #aab8e0;
        }
        
        .dark-mode .google-ad-space {
            background: #1d2a44;
            border-color: #4a5f8a;
            color: #ffd700;
        }
        
        .dark-mode .tool-input,
        .dark-mode .tool-select,
        .dark-mode .tool-textarea {
            background: #263652;
            border-color: #3e5377;
            color: white;
        }
        
        .dark-mode .badge-item {
            background: #2e3d5a;
            color: #e2ecff;
        }

        .toast-msg {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-left: 8px solid #1d2b64;
            padding: 16px 30px;
            border-radius: 60px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            z-index: 99999;
            font-weight: 500;
        }

        .ats-score {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 30px;
            font-weight: 600;
        }
        
        .ats-excellent { background: #28a745; color: white; }
        .ats-good { background: #ffc107; color: #333; }
        .ats-poor { background: #dc3545; color: white; }

        /* Responsive */
        @media (max-width: 1200px) {
            .editor-layout {
                grid-template-columns: 1fr;
            }
            
            .tools-panel .tools-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
<div class="app-wrapper">

    <!-- GOOGLE AD SPACE - TOP -->
    <div class="google-ad-space">
        <div class="google-ad-placeholder">
            <i class="bi bi-google me-2"></i> Google AdSense Space (Top)
        </div>
        <!-- Google Ads code would go here -->
    </div>

    <!-- Header -->
    <div class="app-header">
        <div class="logo">
            <div class="logo-icon">
                <i class="bi bi-file-person"></i>
            </div>
            <div class="logo-text">
                <h1>ResumeForge</h1>
                <p>Professional Resume Tools</p>
            </div>
        </div>
        
        <div class="d-flex gap-3">
            <button class="btn btn-outline-secondary rounded-pill" onclick="toggleDarkMode()" id="darkBtn">
                <i class="bi bi-moon"></i> Dark
            </button>
            <button class="btn btn-outline-primary rounded-pill" onclick="newResume()">
                <i class="bi bi-plus-circle"></i> New
            </button>
        </div>
    </div>

    <!-- Main Editor Layout -->
    <div class="editor-layout">
        <!-- Left Tools Panel -->
        <div class="tools-panel">
            <div class="tools-header">
                <i class="bi bi-tools"></i>
                <span>Resume Tools</span>
            </div>
            
            <div class="tools-grid">
                <button class="tool-btn active" onclick="setActiveTool(this, 'personal')">
                    <i class="bi bi-person"></i>
                    <span>Personal Info</span>
                </button>
                <button class="tool-btn" onclick="setActiveTool(this, 'experience')">
                    <i class="bi bi-briefcase"></i>
                    <span>Experience</span>
                </button>
                <button class="tool-btn" onclick="setActiveTool(this, 'education')">
                    <i class="bi bi-mortarboard"></i>
                    <span>Education</span>
                </button>
                <button class="tool-btn" onclick="setActiveTool(this, 'skills')">
                    <i class="bi bi-code-square"></i>
                    <span>Skills</span>
                </button>
                <button class="tool-btn" onclick="setActiveTool(this, 'languages')">
                    <i class="bi bi-translate"></i>
                    <span>Languages</span>
                </button>
                <button class="tool-btn" onclick="setActiveTool(this, 'certifications')">
                    <i class="bi bi-patch-check"></i>
                    <span>Certifications</span>
                </button>
                <button class="tool-btn" onclick="setActiveTool(this, 'analyze')">
                    <i class="bi bi-graph-up"></i>
                    <span>ATS Analyze</span>
                </button>
                <button class="tool-btn" onclick="setActiveTool(this, 'templates')">
                    <i class="bi bi-layout-three-columns"></i>
                    <span>Templates</span>
                </button>
            </div>
            
            <div class="mt-4">
                <button class="btn-primary-custom w-100" onclick="applyTool()">
                    <i class="bi bi-check2"></i> Apply Changes
                </button>
            </div>
        </div>

        <!-- Center Panel (Resume Preview) -->
        <div class="canvas-panel">
            <div class="resume-preview" id="resumePreview">
                <div class="empty-state" id="emptyResumeState" style="display: none;">
                    <i class="bi bi-file-earmark-person"></i>
                    <h4>No Resume Data</h4>
                    <p>Start by adding your information using the tools on the left</p>
                    <button class="btn-primary-custom mt-3" onclick="loadSampleResume()">Load Sample</button>
                </div>
                
                <div id="resumeContent">
                    <!-- Resume content will be dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Right Properties Panel (dynamic) -->
        <div class="properties-panel" id="propertiesPanel">
            <div class="prop-section">
                <div class="prop-title">
                    <i class="bi bi-sliders2"></i>
                    <span id="toolTitle">Personal Information</span>
                </div>
                <div id="toolProperties">
                    <!-- Properties will be loaded dynamically -->
                </div>
                <div class="action-buttons">
                    <button class="btn-primary-custom" onclick="saveCurrentTool()">Save</button>
                    <button class="btn-secondary-custom" onclick="clearCurrentTool()">Clear</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Toolbar -->
    <div class="bottom-toolbar">
        <div class="history-actions">
            <button class="history-btn" onclick="undo()" id="undoBtn" disabled>
                <i class="bi bi-arrow-left"></i>
            </button>
            <button class="history-btn" onclick="redo()" id="redoBtn" disabled>
                <i class="bi bi-arrow-right"></i>
            </button>
        </div>
        
        <div class="resume-stats" id="resumeStats">
            <span><i class="bi bi-files"></i> 0 sections</span>
            <span><i class="bi bi-symmetry-vertical"></i> ATS Score: --</span>
        </div>
        
        <div class="d-flex gap-2">
            <button class="btn btn-outline-primary rounded-pill" onclick="exportPDF()">
                <i class="bi bi-file-pdf"></i> PDF
            </button>
            <button class="btn btn-outline-primary rounded-pill" onclick="exportDOC()">
                <i class="bi bi-file-word"></i> DOC
            </button>
            <button class="export-btn" onclick="exportTXT()">
                <i class="bi bi-download"></i> Export
            </button>
        </div>
    </div>

    <!-- GOOGLE AD SPACE - BOTTOM -->
    <div class="google-ad-space mt-4">
        <div class="google-ad-placeholder">
            <i class="bi bi-google me-2"></i> Google AdSense Space (Bottom)
        </div>
        <!-- Google Ads code would go here -->
    </div>

    <!-- Footer -->
    <footer class="text-center small text-muted mt-4">
        ResumeForge v1.0 · Complete resume toolkit with ATS optimization
    </footer>
</div>

<script>
    // ==================== GLOBALS ====================
    let currentTool = 'personal';
    let resumeData = {
        personal: {
            fullName: 'John Doe',
            title: 'Software Engineer',
            email: 'john.doe@email.com',
            phone: '+1 (555) 123-4567',
            location: 'San Francisco, CA',
            summary: 'Experienced software engineer with 5+ years in full-stack development.'
        },
        experience: [
            { company: 'Tech Corp', position: 'Senior Developer', startDate: '2021', endDate: 'Present', description: 'Led development of cloud applications.' },
            { company: 'StartUp Inc', position: 'Developer', startDate: '2019', endDate: '2021', description: 'Built responsive web applications.' }
        ],
        education: [
            { institution: 'University of Technology', degree: 'B.S. Computer Science', startDate: '2015', endDate: '2019', gpa: '3.8' }
        ],
        skills: ['JavaScript', 'Python', 'React', 'Node.js', 'AWS', 'Docker'],
        languages: [
            { name: 'English', proficiency: 'Native' },
            { name: 'Spanish', proficiency: 'Intermediate' }
        ],
        certifications: [
            { name: 'AWS Certified Developer', issuer: 'Amazon', year: '2022' }
        ]
    };
    
    let history = [];
    let historyIndex = -1;

    // DOM elements
    const resumeContent = document.getElementById('resumeContent');
    const emptyResumeState = document.getElementById('emptyResumeState');
    const toolProperties = document.getElementById('toolProperties');
    const toolTitle = document.getElementById('toolTitle');
    const resumeStats = document.getElementById('resumeStats');

    // ==================== UTILITIES ====================
    function showToast(m) { 
        let t = document.createElement('div'); 
        t.className = 'toast-msg'; 
        t.innerText = m; 
        document.body.appendChild(t); 
        setTimeout(() => t.remove(), 2000); 
    }
    
    function toggleDarkMode() { 
        document.body.classList.toggle('dark-mode'); 
        const b = document.getElementById('darkBtn'); 
        b.innerHTML = document.body.classList.contains('dark-mode') ? 
            '<i class="bi bi-sun"></i> Light' : 
            '<i class="bi bi-moon"></i> Dark'; 
    }

    // ==================== TOOL MANAGEMENT ====================
    const toolPropertiesTemplates = {
        personal: `
            <div class="prop-control">
                <label>Full Name:</label>
                <input class="tool-input" id="personalName" value="${resumeData.personal.fullName}">
            </div>
            <div class="prop-control">
                <label>Professional Title:</label>
                <input class="tool-input" id="personalTitle" value="${resumeData.personal.title}">
            </div>
            <div class="prop-control">
                <label>Email:</label>
                <input class="tool-input" id="personalEmail" value="${resumeData.personal.email}">
            </div>
            <div class="prop-control">
                <label>Phone:</label>
                <input class="tool-input" id="personalPhone" value="${resumeData.personal.phone}">
            </div>
            <div class="prop-control">
                <label>Location:</label>
                <input class="tool-input" id="personalLocation" value="${resumeData.personal.location}">
            </div>
            <div class="prop-control">
                <label>Professional Summary:</label>
                <textarea class="tool-textarea" id="personalSummary">${resumeData.personal.summary}</textarea>
            </div>
        `,
        experience: `
            <div class="prop-control">
                <label>Add Experience:</label>
                <button class="btn-secondary-custom w-100 mb-2" onclick="addExperience()">+ Add New</button>
            </div>
            <div id="experienceList">
                ${resumeData.experience.map((exp, idx) => `
                    <div class="prop-control border-bottom pb-2 mb-2">
                        <label>Company:</label>
                        <input class="tool-input mb-1" id="exp_company_${idx}" value="${exp.company}">
                        <label>Position:</label>
                        <input class="tool-input mb-1" id="exp_position_${idx}" value="${exp.position}">
                        <label>Start Date:</label>
                        <input class="tool-input mb-1" id="exp_start_${idx}" value="${exp.startDate}">
                        <label>End Date:</label>
                        <input class="tool-input mb-1" id="exp_end_${idx}" value="${exp.endDate}">
                        <label>Description:</label>
                        <textarea class="tool-textarea mb-1" id="exp_desc_${idx}">${exp.description}</textarea>
                        <button class="btn btn-sm btn-outline-danger rounded-pill mt-1" onclick="removeExperience(${idx})">Remove</button>
                    </div>
                `).join('')}
            </div>
        `,
        education: `
            <div class="prop-control">
                <label>Add Education:</label>
                <button class="btn-secondary-custom w-100 mb-2" onclick="addEducation()">+ Add New</button>
            </div>
            <div id="educationList">
                ${resumeData.education.map((edu, idx) => `
                    <div class="prop-control border-bottom pb-2 mb-2">
                        <label>Institution:</label>
                        <input class="tool-input mb-1" id="edu_institution_${idx}" value="${edu.institution}">
                        <label>Degree:</label>
                        <input class="tool-input mb-1" id="edu_degree_${idx}" value="${edu.degree}">
                        <label>Start Date:</label>
                        <input class="tool-input mb-1" id="edu_start_${idx}" value="${edu.startDate}">
                        <label>End Date:</label>
                        <input class="tool-input mb-1" id="edu_end_${idx}" value="${edu.endDate}">
                        <label>GPA (optional):</label>
                        <input class="tool-input mb-1" id="edu_gpa_${idx}" value="${edu.gpa || ''}">
                        <button class="btn btn-sm btn-outline-danger rounded-pill mt-1" onclick="removeEducation(${idx})">Remove</button>
                    </div>
                `).join('')}
            </div>
        `,
        skills: `
            <div class="prop-control">
                <label>Add Skill:</label>
                <div class="d-flex gap-2">
                    <input class="tool-input" id="newSkill" placeholder="e.g., JavaScript">
                    <button class="btn-primary-custom" onclick="addSkill()">Add</button>
                </div>
            </div>
            <div class="badge-container" id="skillsList">
                ${resumeData.skills.map(skill => `
                    <span class="badge-item">
                        ${skill} <i class="bi bi-x" onclick="removeSkill('${skill}')"></i>
                    </span>
                `).join('')}
            </div>
        `,
        languages: `
            <div class="prop-control">
                <label>Add Language:</label>
                <div class="d-flex gap-2 mb-2">
                    <input class="tool-input" id="newLangName" placeholder="Language">
                    <select class="tool-select" id="newLangLevel">
                        <option value="Basic">Basic</option>
                        <option value="Intermediate">Intermediate</option>
                        <option value="Advanced">Advanced</option>
                        <option value="Native">Native</option>
                    </select>
                    <button class="btn-primary-custom" onclick="addLanguage()">Add</button>
                </div>
            </div>
            <div id="languagesList">
                ${resumeData.languages.map((lang, idx) => `
                    <div class="badge-item">
                        ${lang.name} (${lang.proficiency}) 
                        <i class="bi bi-x" onclick="removeLanguage(${idx})"></i>
                    </div>
                `).join('')}
            </div>
        `,
        certifications: `
            <div class="prop-control">
                <label>Add Certification:</label>
                <button class="btn-secondary-custom w-100 mb-2" onclick="addCertification()">+ Add New</button>
            </div>
            <div id="certificationsList">
                ${resumeData.certifications.map((cert, idx) => `
                    <div class="prop-control border-bottom pb-2 mb-2">
                        <label>Certification Name:</label>
                        <input class="tool-input mb-1" id="cert_name_${idx}" value="${cert.name}">
                        <label>Issuer:</label>
                        <input class="tool-input mb-1" id="cert_issuer_${idx}" value="${cert.issuer}">
                        <label>Year:</label>
                        <input class="tool-input mb-1" id="cert_year_${idx}" value="${cert.year}">
                        <button class="btn btn-sm btn-outline-danger rounded-pill mt-1" onclick="removeCertification(${idx})">Remove</button>
                    </div>
                `).join('')}
            </div>
        `,
        analyze: `
            <div class="prop-control text-center">
                <h5 class="mb-3">ATS Compatibility Score</h5>
                <div class="display-1 mb-3" id="atsScore">85</div>
                <div class="ats-score ats-good mb-3" id="atsRating">Good</div>
                <button class="btn-primary-custom w-100 mb-2" onclick="analyzeATS()">Analyze Resume</button>
                <div class="text-start mt-3">
                    <h6>Suggestions:</h6>
                    <ul class="small" id="atsSuggestions">
                        <li>Add more keywords related to your target role</li>
                        <li>Include measurable achievements</li>
                        <li>Optimize section headings</li>
                    </ul>
                </div>
            </div>
        `,
        templates: `
            <div class="prop-control">
                <label>Select Template:</label>
                <select class="tool-select" id="templateSelect" onchange="changeTemplate(this.value)">
                    <option value="modern">Modern</option>
                    <option value="classic">Classic</option>
                    <option value="minimal">Minimal</option>
                    <option value="creative">Creative</option>
                </select>
            </div>
            <div class="prop-control">
                <label>Font Size:</label>
                <input type="range" class="range-slider" id="fontSize" min="10" max="14" value="12" oninput="updateFontSize(this.value)">
            </div>
            <div class="prop-control">
                <label>Spacing:</label>
                <input type="range" class="range-slider" id="spacing" min="0" max="20" value="10" oninput="updateSpacing(this.value)">
            </div>
        `
    };

    function setActiveTool(btn, tool) {
        document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentTool = tool;
        
        // Update title
        const titles = {
            personal: 'Personal Information',
            experience: 'Work Experience',
            education: 'Education',
            skills: 'Skills',
            languages: 'Languages',
            certifications: 'Certifications',
            analyze: 'ATS Analysis',
            templates: 'Template Settings'
        };
        toolTitle.innerText = titles[tool] || 'Settings';
        
        // Load properties
        toolProperties.innerHTML = toolPropertiesTemplates[tool] || '<div class="text-center text-muted py-4">No settings available</div>';
    }

    // ==================== RESUME RENDERING ====================
    function renderResume() {
        const hasData = resumeData.personal.fullName !== 'John Doe' || 
                       resumeData.experience.length > 0 || 
                       resumeData.education.length > 0;
        
        if (!hasData && resumeData.personal.fullName === 'John Doe') {
            emptyResumeState.style.display = 'block';
            resumeContent.style.display = 'none';
        } else {
            emptyResumeState.style.display = 'none';
            resumeContent.style.display = 'block';
            
            let html = `
                <div class="resume-header">
                    <div class="resume-name">${resumeData.personal.fullName}</div>
                    <div class="resume-title">${resumeData.personal.title}</div>
                    <div class="resume-contact">
                        <span><i class="bi bi-envelope"></i> ${resumeData.personal.email}</span>
                        <span><i class="bi bi-telephone"></i> ${resumeData.personal.phone}</span>
                        <span><i class="bi bi-geo-alt"></i> ${resumeData.personal.location}</span>
                    </div>
                </div>
            `;
            
            // Summary
            if (resumeData.personal.summary) {
                html += `
                    <div class="resume-section">
                        <div class="resume-section-title">Professional Summary</div>
                        <p>${resumeData.personal.summary}</p>
                    </div>
                `;
            }
            
            // Experience
            if (resumeData.experience.length > 0) {
                html += `<div class="resume-section"><div class="resume-section-title">Work Experience</div>`;
                resumeData.experience.forEach(exp => {
                    html += `
                        <div class="resume-item">
                            <div class="resume-item-header">
                                <span>${exp.position}</span>
                                <span>${exp.startDate} - ${exp.endDate}</span>
                            </div>
                            <div class="resume-item-sub">${exp.company}</div>
                            <p class="mt-2">${exp.description}</p>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            
            // Education
            if (resumeData.education.length > 0) {
                html += `<div class="resume-section"><div class="resume-section-title">Education</div>`;
                resumeData.education.forEach(edu => {
                    html += `
                        <div class="resume-item">
                            <div class="resume-item-header">
                                <span>${edu.degree}</span>
                                <span>${edu.startDate} - ${edu.endDate}</span>
                            </div>
                            <div class="resume-item-sub">${edu.institution} ${edu.gpa ? `· GPA: ${edu.gpa}` : ''}</div>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            
            // Skills
            if (resumeData.skills.length > 0) {
                html += `
                    <div class="resume-section">
                        <div class="resume-section-title">Skills</div>
                        <div class="badge-container">
                            ${resumeData.skills.map(s => `<span class="badge-item">${s}</span>`).join('')}
                        </div>
                    </div>
                `;
            }
            
            // Languages
            if (resumeData.languages.length > 0) {
                html += `
                    <div class="resume-section">
                        <div class="resume-section-title">Languages</div>
                        <div class="badge-container">
                            ${resumeData.languages.map(l => `<span class="badge-item">${l.name} (${l.proficiency})</span>`).join('')}
                        </div>
                    </div>
                `;
            }
            
            // Certifications
            if (resumeData.certifications.length > 0) {
                html += `
                    <div class="resume-section">
                        <div class="resume-section-title">Certifications</div>
                        ${resumeData.certifications.map(cert => `
                            <div class="resume-item">
                                <div class="resume-item-header">
                                    <span>${cert.name}</span>
                                    <span>${cert.year}</span>
                                </div>
                                <div class="resume-item-sub">${cert.issuer}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            resumeContent.innerHTML = html;
        }
        
        updateStats();
        addToHistory();
    }

    function updateStats() {
        const sectionCount = [
            resumeData.experience.length > 0 ? 1 : 0,
            resumeData.education.length > 0 ? 1 : 0,
            resumeData.skills.length > 0 ? 1 : 0,
            resumeData.languages.length > 0 ? 1 : 0,
            resumeData.certifications.length > 0 ? 1 : 0
        ].reduce((a, b) => a + b, 0);
        
        const atsScore = calculateATSScore();
        let atsClass = 'ats-poor';
        if (atsScore >= 80) atsClass = 'ats-excellent';
        else if (atsScore >= 60) atsClass = 'ats-good';
        
        resumeStats.innerHTML = `
            <span><i class="bi bi-files"></i> ${sectionCount} sections</span>
            <span><i class="bi bi-symmetry-vertical"></i> ATS Score: <span class="${atsClass} px-2 rounded">${atsScore}</span></span>
        `;
    }

    // ==================== TOOL ACTIONS ====================
    function saveCurrentTool() {
        switch(currentTool) {
            case 'personal':
                resumeData.personal.fullName = document.getElementById('personalName').value;
                resumeData.personal.title = document.getElementById('personalTitle').value;
                resumeData.personal.email = document.getElementById('personalEmail').value;
                resumeData.personal.phone = document.getElementById('personalPhone').value;
                resumeData.personal.location = document.getElementById('personalLocation').value;
                resumeData.personal.summary = document.getElementById('personalSummary').value;
                break;
                
            case 'experience':
                // Already handled by individual add/remove
                break;
                
            case 'education':
                // Already handled by individual add/remove
                break;
        }
        
        renderResume();
        showToast('Changes saved');
    }

    function clearCurrentTool() {
        if (confirm('Clear all data in this section?')) {
            switch(currentTool) {
                case 'personal':
                    resumeData.personal = {
                        fullName: '',
                        title: '',
                        email: '',
                        phone: '',
                        location: '',
                        summary: ''
                    };
                    break;
                case 'experience':
                    resumeData.experience = [];
                    break;
                case 'education':
                    resumeData.education = [];
                    break;
                case 'skills':
                    resumeData.skills = [];
                    break;
                case 'languages':
                    resumeData.languages = [];
                    break;
                case 'certifications':
                    resumeData.certifications = [];
                    break;
            }
            
            // Refresh tool properties
            toolProperties.innerHTML = toolPropertiesTemplates[currentTool];
            renderResume();
            showToast('Section cleared');
        }
    }

    // Experience functions
    function addExperience() {
        resumeData.experience.push({
            company: 'New Company',
            position: 'New Position',
            startDate: '2023',
            endDate: 'Present',
            description: 'Job description'
        });
        toolProperties.innerHTML = toolPropertiesTemplates.experience;
        renderResume();
    }

    function removeExperience(index) {
        resumeData.experience.splice(index, 1);
        toolProperties.innerHTML = toolPropertiesTemplates.experience;
        renderResume();
    }

    // Education functions
    function addEducation() {
        resumeData.education.push({
            institution: 'New Institution',
            degree: 'New Degree',
            startDate: '2020',
            endDate: '2024',
            gpa: ''
        });
        toolProperties.innerHTML = toolPropertiesTemplates.education;
        renderResume();
    }

    function removeEducation(index) {
        resumeData.education.splice(index, 1);
        toolProperties.innerHTML = toolPropertiesTemplates.education;
        renderResume();
    }

    // Skills functions
    function addSkill() {
        const newSkill = document.getElementById('newSkill')?.value;
        if (newSkill && !resumeData.skills.includes(newSkill)) {
            resumeData.skills.push(newSkill);
            toolProperties.innerHTML = toolPropertiesTemplates.skills;
            renderResume();
        }
    }

    function removeSkill(skill) {
        resumeData.skills = resumeData.skills.filter(s => s !== skill);
        toolProperties.innerHTML = toolPropertiesTemplates.skills;
        renderResume();
    }

    // Languages functions
    function addLanguage() {
        const name = document.getElementById('newLangName')?.value;
        const level = document.getElementById('newLangLevel')?.value;
        if (name) {
            resumeData.languages.push({ name, proficiency: level });
            toolProperties.innerHTML = toolPropertiesTemplates.languages;
            renderResume();
        }
    }

    function removeLanguage(index) {
        resumeData.languages.splice(index, 1);
        toolProperties.innerHTML = toolPropertiesTemplates.languages;
        renderResume();
    }

    // Certifications functions
    function addCertification() {
        resumeData.certifications.push({
            name: 'New Certification',
            issuer: 'New Issuer',
            year: '2023'
        });
        toolProperties.innerHTML = toolPropertiesTemplates.certifications;
        renderResume();
    }

    function removeCertification(index) {
        resumeData.certifications.splice(index, 1);
        toolProperties.innerHTML = toolPropertiesTemplates.certifications;
        renderResume();
    }

    // ==================== ATS ANALYSIS ====================
    function calculateATSScore() {
        let score = 50;
        
        // Check for required sections
        if (resumeData.personal.fullName && resumeData.personal.email) score += 5;
        if (resumeData.experience.length > 0) score += 10;
        if (resumeData.education.length > 0) score += 5;
        if (resumeData.skills.length > 5) score += 5;
        if (resumeData.certifications.length > 0) score += 5;
        
        // Keyword density (simplified)
        const commonKeywords = ['developed', 'managed', 'led', 'created', 'implemented', 'achieved'];
        const resumeText = JSON.stringify(resumeData).toLowerCase();
        const keywordCount = commonKeywords.filter(k => resumeText.includes(k)).length;
        score += keywordCount * 2;
        
        return Math.min(100, score);
    }

    function analyzeATS() {
        const score = calculateATSScore();
        document.getElementById('atsScore').innerText = score;
        
        let rating = 'Poor';
        let ratingClass = 'ats-poor';
        if (score >= 80) {
            rating = 'Excellent';
            ratingClass = 'ats-excellent';
        } else if (score >= 60) {
            rating = 'Good';
            ratingClass = 'ats-good';
        }
        
        document.getElementById('atsRating').innerText = rating;
        document.getElementById('atsRating').className = `ats-score ${ratingClass} mb-3`;
        
        // Generate suggestions
        const suggestions = [];
        if (!resumeData.personal.summary) suggestions.push('Add a professional summary');
        if (resumeData.experience.length < 2) suggestions.push('Add more work experience');
        if (resumeData.skills.length < 5) suggestions.push('Add more skills');
        if (!resumeData.certifications.length) suggestions.push('Consider adding certifications');
        
        document.getElementById('atsSuggestions').innerHTML = suggestions.map(s => `<li>${s}</li>`).join('');
        
        showToast('ATS Analysis complete');
    }

    // ==================== TEMPLATE FUNCTIONS ====================
    function changeTemplate(template) {
        const preview = document.querySelector('.resume-preview');
        preview.className = `resume-preview template-${template}`;
        showToast(`Template changed to ${template}`);
    }

    function updateFontSize(size) {
        document.querySelector('.resume-preview').style.fontSize = size + 'px';
    }

    function updateSpacing(spacing) {
        document.querySelector('.resume-preview').style.lineHeight = (spacing / 10) + 1;
    }

    // ==================== EXPORT FUNCTIONS ====================
    function exportPDF() {
        showToast('PDF export simulated - would download PDF');
    }

    function exportDOC() {
        showToast('DOC export simulated - would download Word document');
    }

    function exportTXT() {
        const content = generateTextResume();
        const blob = new Blob([content], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'resume.txt';
        a.click();
        URL.revokeObjectURL(url);
        showToast('Resume exported as TXT');
    }

    function generateTextResume() {
        let text = `${resumeData.personal.fullName}\n`;
        text += `${resumeData.personal.title}\n`;
        text += `${resumeData.personal.email} | ${resumeData.personal.phone} | ${resumeData.personal.location}\n\n`;
        text += `SUMMARY\n${resumeData.personal.summary}\n\n`;
        
        text += `EXPERIENCE\n`;
        resumeData.experience.forEach(exp => {
            text += `${exp.position} at ${exp.company} (${exp.startDate}-${exp.endDate})\n`;
            text += `${exp.description}\n\n`;
        });
        
        return text;
    }

    // ==================== HISTORY ====================
    function addToHistory() {
        history = history.slice(0, historyIndex + 1);
        history.push(JSON.stringify(resumeData));
        historyIndex = history.length - 1;
        updateHistoryButtons();
    }

    function undo() {
        if (historyIndex > 0) {
            historyIndex--;
            resumeData = JSON.parse(history[historyIndex]);
            renderResume();
            updateHistoryButtons();
            showToast('Undo successful');
        }
    }

    function redo() {
        if (historyIndex < history.length - 1) {
            historyIndex++;
            resumeData = JSON.parse(history[historyIndex]);
            renderResume();
            updateHistoryButtons();
            showToast('Redo successful');
        }
    }

    function updateHistoryButtons() {
        document.getElementById('undoBtn').disabled = historyIndex <= 0;
        document.getElementById('redoBtn').disabled = historyIndex >= history.length - 1;
    }

    // ==================== RESET ====================
    function newResume() {
        if (confirm('Create new resume? Current data will be lost.')) {
            resumeData = {
                personal: {
                    fullName: '',
                    title: '',
                    email: '',
                    phone: '',
                    location: '',
                    summary: ''
                },
                experience: [],
                education: [],
                skills: [],
                languages: [],
                certifications: []
            };
            renderResume();
            showToast('New resume created');
        }
    }

    function loadSampleResume() {
        resumeData = {
            personal: {
                fullName: 'John Doe',
                title: 'Software Engineer',
                email: 'john.doe@email.com',
                phone: '+1 (555) 123-4567',
                location: 'San Francisco, CA',
                summary: 'Experienced software engineer with 5+ years in full-stack development. Passionate about creating efficient, scalable applications.'
            },
            experience: [
                { company: 'Tech Corp', position: 'Senior Developer', startDate: '2021', endDate: 'Present', description: 'Led development of cloud applications. Improved performance by 40%.' },
                { company: 'StartUp Inc', position: 'Developer', startDate: '2019', endDate: '2021', description: 'Built responsive web applications using React and Node.js.' }
            ],
            education: [
                { institution: 'University of Technology', degree: 'B.S. Computer Science', startDate: '2015', endDate: '2019', gpa: '3.8' }
            ],
            skills: ['JavaScript', 'Python', 'React', 'Node.js', 'AWS', 'Docker', 'MongoDB', 'TypeScript'],
            languages: [
                { name: 'English', proficiency: 'Native' },
                { name: 'Spanish', proficiency: 'Intermediate' }
            ],
            certifications: [
                { name: 'AWS Certified Developer', issuer: 'Amazon', year: '2022' }
            ]
        };
        renderResume();
        showToast('Sample resume loaded');
    }

    // ==================== APPLY TOOL ====================
    function applyTool() {
        saveCurrentTool();
    }

    // ==================== INITIALIZATION ====================
    window.onload = function() {
        renderResume();
        addToHistory();
    };
</script>
</body>
</html>
